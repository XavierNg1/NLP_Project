
Dig a hole, two blocks down and two blocks wide.
Create containers for the lava and water, but don't place them just yet.
Next, we'll set up a redstone contraption to detect when a block of cobblestone is formed.
Now, to get the piston to push.
Now place the water first, then the lava.
Add a repeater to the block on the lava container that's right next to the first redstone wire we put down.
Now, to stop keep it from doing this, add a detector that tells when the piston that is pushing sideways can't push any more blocks.
Finally, adding an on/off switch.
Mine to your heart's content.

