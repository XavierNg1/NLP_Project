
Preheat the oven to 350°F (177°C) and grease a 2-quart (2 liters) casserole dish with cooking spray.
Melt the butter in a large saucepan over medium heat, then add the onion and cook for 2 minutes.
Whisk in the flour, salt, and pepper and cook until it turns smooth and bubbly.
Stir in the milk.
Return the sauce to a boil and let it cook for 1 minute.
Arrange the potatoes and ham in the casserole dish and gently pat them down until the surface is smooth.
Pour the sauce over the potatoes, then add the butter.
Bake the potatoes, covered, for 30 minutes, then bake them uncovered for another 60 minutes.
Let the potatoes stand for 5 to 10 minutes before serving.