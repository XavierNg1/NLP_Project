 Line a standard-sized, 12-hole muffin tin with paper liners.

You can do this method using your own cupcake recipe. If you are using your own recipe, prepare it as you normally would, then ] to continue.
 Pour the flour, cocoa powder, baking soda, and baking powder into a large mixing bowl. Mix everything together, then set the bowl aside., You can do this in a large bowl with a handheld beater, in a stand mixer, or in a food processor. Beat the three together until they turn light and fluffy., Add the eggs into the butter mixture one by one. Beat the mixture well after each egg that you add. At the very end, stir in the buttermilk and the vanilla extract., Pour half of the flour mixture into the butter mixture. Stir it in, then add the remaining half. Mix everything together using a medium speed setting until just combined., Fill each well no more than ⅔ to ¾ of the way, otherwise the batter may overflow.To make things easier, use a soup ladle or an ice cream scoop to fill the wells.

Plan on using about 3 tablespoons (45 milliliters) of batter per cupcake., The cupcakes are ready when a toothpick inserted into the middle comes out clean. Let the cupcakes cool in the tin for 5 minutes, then transfer them to a wire rack to finish cooling off.
 If you have not already, let the cupcakes cool off completely first. Next, cut a 1-inch (2.54-centimeter) wide, 1-inch (2.54-centimeter) deep hole into each cupcake. You can do this with a paring knife or with a small spoon. Discard the pats that you cut out, or save them for making cake pops.

Paring knife: set the knife into the top of the cupcake at a 45-degree angle. Cut a cone-shape out of the middle of the cupcake.
Spoon: use a melon scoop or a spoon to scoop out the middle of the cupcake.
 If you are making these for a gender-reveal party, consider using pink (for a girl) or blue (for a boy). Set the cupcakes aside when you are done.

Make sure that the inside of the cupcakes are cool before you fill them with M&M's. If they are warm, the candy will melt.
 Cream the butter using a handheld beater, electric mixer, or food processor fitted with whisks. Beat in 1 cup (125 grams) of the icing sugar, then add 1 to 2 tablespoons (15 to 30 milliliters) of milk. Add in the rest of the powdered sugar, 1 cup (125 grams) at a time. If the frosting is too stiff, add in 1 to 2 more tablespoons (15 to 30 milliliters) of milk.

You can also use your own icing recipe instead.
If this is for a gender reveal party, consider coloring the frosting purple to leave people guessing.
 Fit a piping bag with a large, open star tip. Pipe the frosting onto the cupcakes, making sure to cover up the M&M's. If you have any M&M's left over, you can stick them on top of the frosting. You can also grind them up in a blender or food processor, then sprinkle them over the frosting instead.